{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst API_KEY = \"41856327-3235cf4f5968f0d75f22e6e35\";\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.getElementById(\"search-input\");\nconst imageGallery = document.getElementById(\"image-gallery\");\nconst spinner = document.getElementById(\"spinner\");\nconst loadMoreBtn = document.getElementById(\"load-more\");\n\nlet lightbox;\nlet currentPage = 1;\nlet pageSize = 40;\nlet currentQuery = \"\";\n\nconst scrollPage = () => {\n  const galleryItem = document.querySelector('.gallery-item');\n  const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    behavior: 'smooth',\n  });\n}\nsearchForm.addEventListener(\"submit\", async (event) => {\n  \n  event.preventDefault();\n  const query = searchInput.value.trim();\n  if (query === \"\") return;\n  currentQuery = query;\n\n  try {\n    toggleSpinner(true);\n    const response = await axios.get(`https://pixabay.com/api/?key=${API_KEY}&q=${currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${pageSize}`);\n    const data = response.data;\n    displayImages(data.hits.slice(0, pageSize));\n    currentPage = 1;\n  } catch (error) {\n    showError();\n  } finally {\n    toggleSpinner(false);\n    toggleLoadMoreBtn();\n    \n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loadMoreBtn.setAttribute(\"style\", \"display: none;\");\n  currentPage +=1;\n  await fetchAndDisplayImages();\n  scrollPage();\n  \n});\n\nasync function fetchAndDisplayImages() {\n  try {\n    const query = searchInput.value.trim();\n    if (query === '') return;\n\n    toggleSpinner(true);\n\n    const response = await axios.get(`https://pixabay.com/api/?key=${API_KEY}&q=${currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${pageSize}`);\n\n    const data = response.data;\n    appendImages(data.hits.slice(0, pageSize));\n  } catch (error) {\n    // showError();\n    theEnd();\n  } finally {\n    toggleSpinner(false);\n  }\n}\n\nfunction displayImages(images) {\n  if (images.length === 0) {\n    showError();\n    return;\n  }\n\n   if (images.length < pageSize) {\n    toggleLoadMoreBtn(false);\n    toggleSpinner(false);\n  } else {\n    toggleLoadMoreBtn(true);\n  }\n\n  imageGallery.innerHTML = \"\";\n  const imageElements = images.map(createImageElement);\n  imageGallery.append(...imageElements);\n\n  lightbox = new SimpleLightbox('.gallery a', {\n    q: currentQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: pageSize\n  });\n  lightbox.refresh();\n}\n\nfunction appendImages(images) {\n  if (images.length === 0) {\n    toggleLoadMoreBtn(false);\n    toggleSpinner(false);\n    theEnd();\n    return;\n  }\n\n  const imageElements = images.map(createImageElement);\n  imageGallery.append(...imageElements);\n  lightbox.refresh();\n}\n\nfunction createImageElement(image) {\n  const link = document.createElement(\"a\");\n  link.href = image.largeImageURL;\n  link.setAttribute(\"data-lightbox\", \"image-gallery\");\n  link.innerHTML = `\n    <div class=\"gallery-item\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n    </div>\n  `;\n  return link;\n}\n\nfunction theEnd() {\n  \n  loadMoreBtn.setAttribute(\"style\", \"display: none;\");\n  iziToast.info({\n    title: 'Info',\n    message: \"We're sorry, but you've reached the end of search results\",\n    position: 'center',\n  });\n}\n\nfunction showError() {\n  imageGallery.innerHTML = \"\";\n  iziToast.error({\n    title: 'Error',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    position: 'center',\n  });\n}\n\nconst hasImages = () => imageGallery.children.length > 0;\n\nconst toggleLoadMoreBtn = () => {\n  loadMoreBtn.classList.toggle(\"is-hidden\", !hasImages());\n};\n\nconst toggleSpinner = (show) => {\n  spinner.classList.toggle(\"is-hidden\", !show);\n};"],"names":["API_KEY","searchForm","searchInput","imageGallery","spinner","loadMoreBtn","lightbox","currentPage","pageSize","currentQuery","scrollPage","galleryItemHeight","event","query","toggleSpinner","data","axios","displayImages","showError","toggleLoadMoreBtn","fetchAndDisplayImages","appendImages","theEnd","images","imageElements","createImageElement","SimpleLightbox","image","link","iziToast","hasImages","show"],"mappings":"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"}